{
  "sources": [
    {
      "id": "de97e334-24c8-46fa-bbe2-0b8a64e688a2",
      "name": "orderupdate",
      "type": "AzureEventHub",
      "properties": {
        "dataConnectionId": "c2cafc52-a42a-4b04-aaa5-71ff71ece1dc",
        "consumerGroupName": "$Default",
        "inputSerialization": {
          "type": "Json",
          "properties": {
            "encoding": "UTF8"
          }
        }
      }
    }
  ],
  "destinations": [
    {
      "id": "820d7051-73d4-4be5-8a31-c07e79ea0122",
      "name": "lh-edp-prod",
      "type": "Lakehouse",
      "properties": {
        "workspaceId": "00000000-0000-0000-0000-000000000000",
        "itemId": "e1c38ada-52db-8c0c-46aa-c973408d8412",
        "schema": "stream",
        "deltaTable": "orderupdated_raw",
        "minimumRows": 1000000,
        "maximumDurationInSeconds": 300,
        "inputSerialization": {
          "type": "Json",
          "properties": {
            "encoding": "UTF8"
          }
        }
      },
      "inputNodes": [
        {
          "name": "cast_to_string"
        }
      ],
      "inputSchemas": [
        {
          "name": "cast_to_string",
          "schema": {
            "columns": [
              {
                "name": "orderNumber",
                "type": "Nvarchar(max)",
                "fields": null,
                "items": null
              },
              {
                "name": "orderDate",
                "type": "Nvarchar(max)",
                "fields": null,
                "items": null
              },
              {
                "name": "salesBrand",
                "type": "Nvarchar(max)",
                "fields": null,
                "items": null
              },
              {
                "name": "country",
                "type": "Nvarchar(max)",
                "fields": null,
                "items": null
              },
              {
                "name": "currency",
                "type": "Nvarchar(max)",
                "fields": null,
                "items": null
              },
              {
                "name": "source",
                "type": "Nvarchar(max)",
                "fields": null,
                "items": null
              },
              {
                "name": "clientIP",
                "type": "Nvarchar(max)",
                "fields": null,
                "items": null
              },
              {
                "name": "status",
                "type": "Nvarchar(max)",
                "fields": null,
                "items": null
              },
              {
                "name": "fraudStatus",
                "type": "Nvarchar(max)",
                "fields": null,
                "items": null
              },
              {
                "name": "deliveryStatus",
                "type": "Nvarchar(max)",
                "fields": null,
                "items": null
              },
              {
                "name": "customerNumber",
                "type": "Nvarchar(max)",
                "fields": null,
                "items": null
              },
              {
                "name": "invoiceAddress",
                "type": "Nvarchar(max)",
                "fields": null,
                "items": null
              },
              {
                "name": "buckets",
                "type": "Nvarchar(max)",
                "fields": null,
                "items": null
              },
              {
                "name": "offers",
                "type": "Nvarchar(max)",
                "fields": null,
                "items": null
              },
              {
                "name": "payments",
                "type": "Nvarchar(max)",
                "fields": null,
                "items": null
              },
              {
                "name": "logs",
                "type": "Nvarchar(max)",
                "fields": null,
                "items": null
              },
              {
                "name": "total",
                "type": "Nvarchar(max)",
                "fields": null,
                "items": null
              },
              {
                "name": "deliveries",
                "type": "Nvarchar(max)",
                "fields": null,
                "items": null
              },
              {
                "name": "EventProcessedUtcTime",
                "type": "Nvarchar(max)",
                "fields": null,
                "items": null
              },
              {
                "name": "PartitionId",
                "type": "BigInt",
                "fields": null,
                "items": null
              },
              {
                "name": "EventEnqueuedUtcTime",
                "type": "Nvarchar(max)",
                "fields": null,
                "items": null
              }
            ]
          }
        }
      ]
    },
    {
      "id": "8304392a-978c-468a-a493-762f09d0da96",
      "name": "orderupdated-orderstream",
      "type": "Lakehouse",
      "properties": {
        "workspaceId": "00000000-0000-0000-0000-000000000000",
        "itemId": "e1c38ada-52db-8c0c-46aa-c973408d8412",
        "schema": "stream",
        "deltaTable": "orderupdated_orderstream",
        "minimumRows": 1000000,
        "maximumDurationInSeconds": 300,
        "inputSerialization": {
          "type": "Json",
          "properties": {
            "encoding": "UTF8"
          }
        }
      },
      "inputNodes": [
        {
          "name": "flatten_order"
        }
      ],
      "inputSchemas": [
        {
          "name": "flatten_order",
          "schema": {
            "columns": []
          }
        }
      ]
    },
    {
      "id": "bf48d220-0178-456c-8c5f-5bc6571a11d6",
      "name": "orderupdate-rowsstream",
      "type": "Lakehouse",
      "properties": {
        "workspaceId": "00000000-0000-0000-0000-000000000000",
        "itemId": "e1c38ada-52db-8c0c-46aa-c973408d8412",
        "schema": "stream",
        "deltaTable": "orderupdated_rowstream",
        "minimumRows": 1000000,
        "maximumDurationInSeconds": 300,
        "inputSerialization": {
          "type": "Json",
          "properties": {
            "encoding": "UTF8"
          }
        }
      },
      "inputNodes": [
        {
          "name": "flatten_rows"
        }
      ],
      "inputSchemas": [
        {
          "name": "flatten_rows",
          "schema": {
            "columns": []
          }
        }
      ]
    },
    {
      "id": "f2402d3c-df2c-45f0-a523-18b87c7e1dbd",
      "name": "orderupdated-paymentstream",
      "type": "Lakehouse",
      "properties": {
        "workspaceId": "00000000-0000-0000-0000-000000000000",
        "itemId": "e1c38ada-52db-8c0c-46aa-c973408d8412",
        "schema": "stream",
        "deltaTable": "orderupdated_paymentstream",
        "minimumRows": 1000000,
        "maximumDurationInSeconds": 300,
        "inputSerialization": {
          "type": "Json",
          "properties": {
            "encoding": "UTF8"
          }
        }
      },
      "inputNodes": [
        {
          "name": "flatten_payment"
        }
      ],
      "inputSchemas": [
        {
          "name": "flatten_payment",
          "schema": {
            "columns": []
          }
        }
      ]
    }
  ],
  "streams": [
    {
      "id": "b072a399-f0d1-4ccd-b06e-bb9ff0ecab9c",
      "name": "orderupdate-stream",
      "type": "DefaultStream",
      "properties": {},
      "inputNodes": [
        {
          "name": "orderupdate"
        }
      ]
    }
  ],
  "operators": [
    {
      "name": "cast_to_string",
      "type": "ManageFields",
      "inputNodes": [
        {
          "name": "orderupdate-stream"
        }
      ],
      "properties": {
        "columns": [
          {
            "type": "Rename",
            "properties": {
              "column": {
                "expressionType": "ColumnReference",
                "node": null,
                "columnName": "orderNumber",
                "columnPathSegments": []
              }
            },
            "alias": "orderNumber"
          },
          {
            "type": "Cast",
            "properties": {
              "targetDataType": "Nvarchar(max)",
              "column": {
                "expressionType": "ColumnReference",
                "node": null,
                "columnName": "orderDate",
                "columnPathSegments": []
              }
            },
            "alias": "orderDate"
          },
          {
            "type": "Rename",
            "properties": {
              "column": {
                "expressionType": "ColumnReference",
                "node": null,
                "columnName": "salesBrand",
                "columnPathSegments": []
              }
            },
            "alias": "salesBrand"
          },
          {
            "type": "Rename",
            "properties": {
              "column": {
                "expressionType": "ColumnReference",
                "node": null,
                "columnName": "country",
                "columnPathSegments": []
              }
            },
            "alias": "country"
          },
          {
            "type": "Rename",
            "properties": {
              "column": {
                "expressionType": "ColumnReference",
                "node": null,
                "columnName": "currency",
                "columnPathSegments": []
              }
            },
            "alias": "currency"
          },
          {
            "type": "FunctionCall",
            "properties": {
              "functionName": "Json_Stringify",
              "arguments": [
                {
                  "expressionType": "ColumnReference",
                  "node": null,
                  "columnName": "source",
                  "columnPathSegments": []
                }
              ]
            },
            "alias": "source"
          },
          {
            "type": "Rename",
            "properties": {
              "column": {
                "expressionType": "ColumnReference",
                "node": null,
                "columnName": "clientIP",
                "columnPathSegments": []
              }
            },
            "alias": "clientIP"
          },
          {
            "type": "FunctionCall",
            "properties": {
              "functionName": "Json_Stringify",
              "arguments": [
                {
                  "expressionType": "ColumnReference",
                  "node": null,
                  "columnName": "status",
                  "columnPathSegments": []
                }
              ]
            },
            "alias": "status"
          },
          {
            "type": "FunctionCall",
            "properties": {
              "functionName": "Json_Stringify",
              "arguments": [
                {
                  "expressionType": "ColumnReference",
                  "node": null,
                  "columnName": "fraudStatus",
                  "columnPathSegments": []
                }
              ]
            },
            "alias": "fraudStatus"
          },
          {
            "type": "FunctionCall",
            "properties": {
              "functionName": "Json_Stringify",
              "arguments": [
                {
                  "expressionType": "ColumnReference",
                  "node": null,
                  "columnName": "deliveryStatus",
                  "columnPathSegments": []
                }
              ]
            },
            "alias": "deliveryStatus"
          },
          {
            "type": "Rename",
            "properties": {
              "column": {
                "expressionType": "ColumnReference",
                "node": null,
                "columnName": "customerNumber",
                "columnPathSegments": []
              }
            },
            "alias": "customerNumber"
          },
          {
            "type": "FunctionCall",
            "properties": {
              "functionName": "Json_Stringify",
              "arguments": [
                {
                  "expressionType": "ColumnReference",
                  "node": null,
                  "columnName": "invoiceAddress",
                  "columnPathSegments": []
                }
              ]
            },
            "alias": "invoiceAddress"
          },
          {
            "type": "FunctionCall",
            "properties": {
              "functionName": "Json_Stringify",
              "arguments": [
                {
                  "expressionType": "ColumnReference",
                  "node": null,
                  "columnName": "buckets",
                  "columnPathSegments": []
                }
              ]
            },
            "alias": "buckets"
          },
          {
            "type": "FunctionCall",
            "properties": {
              "functionName": "Json_Stringify",
              "arguments": [
                {
                  "expressionType": "ColumnReference",
                  "node": null,
                  "columnName": "offers",
                  "columnPathSegments": []
                }
              ]
            },
            "alias": "offers"
          },
          {
            "type": "FunctionCall",
            "properties": {
              "functionName": "Json_Stringify",
              "arguments": [
                {
                  "expressionType": "ColumnReference",
                  "node": null,
                  "columnName": "payments",
                  "columnPathSegments": []
                }
              ]
            },
            "alias": "payments"
          },
          {
            "type": "FunctionCall",
            "properties": {
              "functionName": "Json_Stringify",
              "arguments": [
                {
                  "expressionType": "ColumnReference",
                  "node": null,
                  "columnName": "logs",
                  "columnPathSegments": []
                }
              ]
            },
            "alias": "logs"
          },
          {
            "type": "FunctionCall",
            "properties": {
              "functionName": "Json_Stringify",
              "arguments": [
                {
                  "expressionType": "ColumnReference",
                  "node": null,
                  "columnName": "total",
                  "columnPathSegments": []
                }
              ]
            },
            "alias": "total"
          },
          {
            "type": "FunctionCall",
            "properties": {
              "functionName": "Json_Stringify",
              "arguments": [
                {
                  "expressionType": "ColumnReference",
                  "node": null,
                  "columnName": "deliveries",
                  "columnPathSegments": []
                }
              ]
            },
            "alias": "deliveries"
          },
          {
            "type": "Cast",
            "properties": {
              "targetDataType": "Nvarchar(max)",
              "column": {
                "expressionType": "ColumnReference",
                "node": null,
                "columnName": "EventProcessedUtcTime",
                "columnPathSegments": []
              }
            },
            "alias": "EventProcessedUtcTime"
          },
          {
            "type": "Rename",
            "properties": {
              "column": {
                "expressionType": "ColumnReference",
                "node": null,
                "columnName": "PartitionId",
                "columnPathSegments": []
              }
            },
            "alias": "PartitionId"
          },
          {
            "type": "Cast",
            "properties": {
              "targetDataType": "Nvarchar(max)",
              "column": {
                "expressionType": "ColumnReference",
                "node": null,
                "columnName": "EventEnqueuedUtcTime",
                "columnPathSegments": []
              }
            },
            "alias": "EventEnqueuedUtcTime"
          }
        ]
      },
      "inputSchemas": [
        {
          "name": "orderupdate-stream",
          "schema": {
            "columns": [
              {
                "name": "orderNumber",
                "type": "Nvarchar(max)",
                "fields": null,
                "items": null
              },
              {
                "name": "orderDate",
                "type": "DateTime",
                "fields": null,
                "items": null
              },
              {
                "name": "salesBrand",
                "type": "Nvarchar(max)",
                "fields": null,
                "items": null
              },
              {
                "name": "country",
                "type": "Nvarchar(max)",
                "fields": null,
                "items": null
              },
              {
                "name": "currency",
                "type": "Nvarchar(max)",
                "fields": null,
                "items": null
              },
              {
                "name": "source",
                "type": "Record",
                "fields": [
                  {
                    "name": "name",
                    "type": "Nvarchar(max)",
                    "fields": null,
                    "items": null
                  },
                  {
                    "name": "title",
                    "type": "Nvarchar(max)",
                    "fields": null,
                    "items": null
                  },
                  {
                    "name": "isExternal",
                    "type": "BigInt",
                    "fields": null,
                    "items": null
                  }
                ],
                "items": null
              },
              {
                "name": "clientIP",
                "type": "Nvarchar(max)",
                "fields": null,
                "items": null
              },
              {
                "name": "status",
                "type": "Record",
                "fields": [
                  {
                    "name": "value",
                    "type": "Nvarchar(max)",
                    "fields": null,
                    "items": null
                  },
                  {
                    "name": "title",
                    "type": "Nvarchar(max)",
                    "fields": null,
                    "items": null
                  }
                ],
                "items": null
              },
              {
                "name": "fraudStatus",
                "type": "Record",
                "fields": [
                  {
                    "name": "value",
                    "type": "Nvarchar(max)",
                    "fields": null,
                    "items": null
                  },
                  {
                    "name": "title",
                    "type": "Nvarchar(max)",
                    "fields": null,
                    "items": null
                  }
                ],
                "items": null
              },
              {
                "name": "deliveryStatus",
                "type": "Record",
                "fields": [
                  {
                    "name": "value",
                    "type": "Nvarchar(max)",
                    "fields": null,
                    "items": null
                  },
                  {
                    "name": "title",
                    "type": "Nvarchar(max)",
                    "fields": null,
                    "items": null
                  }
                ],
                "items": null
              },
              {
                "name": "customerNumber",
                "type": "Nvarchar(max)",
                "fields": null,
                "items": null
              },
              {
                "name": "civicNumber",
                "type": "Nvarchar(max)",
                "fields": null,
                "items": null
              },
              {
                "name": "invoiceAddress",
                "type": "Record",
                "fields": [
                  {
                    "name": "firstName",
                    "type": "Nvarchar(max)",
                    "fields": null,
                    "items": null
                  },
                  {
                    "name": "lastName",
                    "type": "Nvarchar(max)",
                    "fields": null,
                    "items": null
                  },
                  {
                    "name": "address",
                    "type": "Record",
                    "fields": [
                      {
                        "name": "street",
                        "type": "Nvarchar(max)",
                        "fields": null,
                        "items": null
                      },
                      {
                        "name": "postalCode",
                        "type": "Nvarchar(max)",
                        "fields": null,
                        "items": null
                      },
                      {
                        "name": "city",
                        "type": "Nvarchar(max)",
                        "fields": null,
                        "items": null
                      },
                      {
                        "name": "countryCode",
                        "type": "Nvarchar(max)",
                        "fields": null,
                        "items": null
                      }
                    ],
                    "items": null
                  },
                  {
                    "name": "email",
                    "type": "Nvarchar(max)",
                    "fields": null,
                    "items": null
                  },
                  {
                    "name": "mobilePhone",
                    "type": "Nvarchar(max)",
                    "fields": null,
                    "items": null
                  }
                ],
                "items": null
              },
              {
                "name": "buckets",
                "type": "Array",
                "fields": null,
                "items": {
                  "name": null,
                  "type": "Record",
                  "fields": [
                    {
                      "name": "bucketNumber",
                      "type": "BigInt",
                      "fields": null,
                      "items": null
                    },
                    {
                      "name": "returnCode",
                      "type": "Nvarchar(max)",
                      "fields": null,
                      "items": null
                    },
                    {
                      "name": "deliveredFrom",
                      "type": "Record",
                      "fields": [
                        {
                          "name": "name",
                          "type": "Nvarchar(max)",
                          "fields": null,
                          "items": null
                        }
                      ],
                      "items": null
                    },
                    {
                      "name": "deliveryAddress",
                      "type": "Record",
                      "fields": [
                        {
                          "name": "firstName",
                          "type": "Nvarchar(max)",
                          "fields": null,
                          "items": null
                        },
                        {
                          "name": "lastName",
                          "type": "Nvarchar(max)",
                          "fields": null,
                          "items": null
                        },
                        {
                          "name": "address",
                          "type": "Record",
                          "fields": [
                            {
                              "name": "street",
                              "type": "Nvarchar(max)",
                              "fields": null,
                              "items": null
                            },
                            {
                              "name": "postalCode",
                              "type": "Nvarchar(max)",
                              "fields": null,
                              "items": null
                            },
                            {
                              "name": "city",
                              "type": "Nvarchar(max)",
                              "fields": null,
                              "items": null
                            },
                            {
                              "name": "countryCode",
                              "type": "Nvarchar(max)",
                              "fields": null,
                              "items": null
                            }
                          ],
                          "items": null
                        },
                        {
                          "name": "email",
                          "type": "Nvarchar(max)",
                          "fields": null,
                          "items": null
                        },
                        {
                          "name": "mobilePhone",
                          "type": "Nvarchar(max)",
                          "fields": null,
                          "items": null
                        }
                      ],
                      "items": null
                    },
                    {
                      "name": "pickupPoint",
                      "type": "Record",
                      "fields": [],
                      "items": null
                    },
                    {
                      "name": "deliveryEstimate",
                      "type": "Record",
                      "fields": [
                        {
                          "name": "date",
                          "type": "Nvarchar(max)",
                          "fields": null,
                          "items": null
                        },
                        {
                          "name": "text",
                          "type": "Nvarchar(max)",
                          "fields": null,
                          "items": null
                        }
                      ],
                      "items": null
                    },
                    {
                      "name": "shipping",
                      "type": "Record",
                      "fields": [
                        {
                          "name": "carrier",
                          "type": "Record",
                          "fields": [
                            {
                              "name": "code",
                              "type": "Nvarchar(max)",
                              "fields": null,
                              "items": null
                            },
                            {
                              "name": "name",
                              "type": "Nvarchar(max)",
                              "fields": null,
                              "items": null
                            }
                          ],
                          "items": null
                        },
                        {
                          "name": "method",
                          "type": "Nvarchar(max)",
                          "fields": null,
                          "items": null
                        },
                        {
                          "name": "title",
                          "type": "Nvarchar(max)",
                          "fields": null,
                          "items": null
                        },
                        {
                          "name": "fee",
                          "type": "BigInt",
                          "fields": null,
                          "items": null
                        },
                        {
                          "name": "returnFee",
                          "type": "Float",
                          "fields": null,
                          "items": null
                        },
                        {
                          "name": "unclaimedFee",
                          "type": "Float",
                          "fields": null,
                          "items": null
                        },
                        {
                          "name": "options",
                          "type": "Array",
                          "fields": null,
                          "items": null
                        }
                      ],
                      "items": null
                    },
                    {
                      "name": "rows",
                      "type": "Array",
                      "fields": null,
                      "items": {
                        "name": null,
                        "type": "Record",
                        "fields": [
                          {
                            "name": "rowNumber",
                            "type": "BigInt",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "sku",
                            "type": "Nvarchar(max)",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "name",
                            "type": "Nvarchar(max)",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "color",
                            "type": "Nvarchar(max)",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "size",
                            "type": "Nvarchar(max)",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "brand",
                            "type": "Record",
                            "fields": [],
                            "items": null
                          },
                          {
                            "name": "url",
                            "type": "Nvarchar(max)",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "imageName",
                            "type": "Nvarchar(max)",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "orderedQuantity",
                            "type": "BigInt",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "deliveredQuantity",
                            "type": "BigInt",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "cancelledQuantity",
                            "type": "BigInt",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "notifiedReturnQuantity",
                            "type": "BigInt",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "returnedQuantity",
                            "type": "BigInt",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "singleBasePrice",
                            "type": "Float",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "singleSalesPrice",
                            "type": "Float",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "offers",
                            "type": "Array",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "manualDiscount",
                            "type": "BigInt",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "totalDiscount",
                            "type": "BigInt",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "totalAmount",
                            "type": "Float",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "vatRate",
                            "type": "Float",
                            "fields": null,
                            "items": null
                          }
                        ],
                        "items": null
                      }
                    }
                  ],
                  "items": null
                }
              },
              {
                "name": "offers",
                "type": "Array",
                "fields": null,
                "items": null
              },
              {
                "name": "payments",
                "type": "Array",
                "fields": null,
                "items": {
                  "name": null,
                  "type": "Record",
                  "fields": [
                    {
                      "name": "title",
                      "type": "Nvarchar(max)",
                      "fields": null,
                      "items": null
                    },
                    {
                      "name": "psp",
                      "type": "Nvarchar(max)",
                      "fields": null,
                      "items": null
                    },
                    {
                      "name": "method",
                      "type": "Nvarchar(max)",
                      "fields": null,
                      "items": null
                    },
                    {
                      "name": "type",
                      "type": "Nvarchar(max)",
                      "fields": null,
                      "items": null
                    },
                    {
                      "name": "isTokenized",
                      "type": "BigInt",
                      "fields": null,
                      "items": null
                    },
                    {
                      "name": "alternative",
                      "type": "Record",
                      "fields": [],
                      "items": null
                    },
                    {
                      "name": "amount",
                      "type": "Float",
                      "fields": null,
                      "items": null
                    },
                    {
                      "name": "pspReference",
                      "type": "Nvarchar(max)",
                      "fields": null,
                      "items": null
                    }
                  ],
                  "items": null
                }
              },
              {
                "name": "logs",
                "type": "Array",
                "fields": null,
                "items": null
              },
              {
                "name": "total",
                "type": "Record",
                "fields": [
                  {
                    "name": "handlingFee",
                    "type": "Float",
                    "fields": null,
                    "items": null
                  },
                  {
                    "name": "shippingFee",
                    "type": "BigInt",
                    "fields": null,
                    "items": null
                  },
                  {
                    "name": "salesAmount",
                    "type": "Float",
                    "fields": null,
                    "items": null
                  },
                  {
                    "name": "discount",
                    "type": "BigInt",
                    "fields": null,
                    "items": null
                  },
                  {
                    "name": "totalAmount",
                    "type": "Float",
                    "fields": null,
                    "items": null
                  },
                  {
                    "name": "creditedAmount",
                    "type": "BigInt",
                    "fields": null,
                    "items": null
                  }
                ],
                "items": null
              },
              {
                "name": "deliveries",
                "type": "Array",
                "fields": null,
                "items": {
                  "name": null,
                  "type": "Record",
                  "fields": [
                    {
                      "name": "deliveryNumber",
                      "type": "Nvarchar(max)",
                      "fields": null,
                      "items": null
                    },
                    {
                      "name": "deliveryDate",
                      "type": "Nvarchar(max)",
                      "fields": null,
                      "items": null
                    },
                    {
                      "name": "carrier",
                      "type": "Record",
                      "fields": [
                        {
                          "name": "code",
                          "type": "Nvarchar(max)",
                          "fields": null,
                          "items": null
                        },
                        {
                          "name": "name",
                          "type": "Nvarchar(max)",
                          "fields": null,
                          "items": null
                        }
                      ],
                      "items": null
                    },
                    {
                      "name": "parcels",
                      "type": "Array",
                      "fields": null,
                      "items": {
                        "name": null,
                        "type": "Record",
                        "fields": [
                          {
                            "name": "parcelNumber",
                            "type": "Nvarchar(max)",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "returnParcelNumber",
                            "type": "Nvarchar(max)",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "trackingLink",
                            "type": "Nvarchar(max)",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "parcelLink",
                            "type": "Nvarchar(max)",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "returnParcelLink",
                            "type": "Nvarchar(max)",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "weight",
                            "type": "Float",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "volume",
                            "type": "Float",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "rows",
                            "type": "Array",
                            "fields": null,
                            "items": {
                              "name": null,
                              "type": "Record",
                              "fields": [
                                {
                                  "name": "rowNumber",
                                  "type": "BigInt",
                                  "fields": null,
                                  "items": null
                                },
                                {
                                  "name": "quantity",
                                  "type": "BigInt",
                                  "fields": null,
                                  "items": null
                                }
                              ],
                              "items": null
                            }
                          }
                        ],
                        "items": null
                      }
                    }
                  ],
                  "items": null
                }
              },
              {
                "name": "EventProcessedUtcTime",
                "type": "DateTime",
                "fields": null,
                "items": null
              },
              {
                "name": "PartitionId",
                "type": "BigInt",
                "fields": null,
                "items": null
              },
              {
                "name": "EventEnqueuedUtcTime",
                "type": "DateTime",
                "fields": null,
                "items": null
              }
            ]
          }
        }
      ]
    },
    {
      "name": "flatten_order",
      "type": "SQL",
      "inputNodes": [
        {
          "name": "orderupdate-stream"
        }
      ],
      "properties": {
        "query": "with \norder_explode as (\nSELECT \n\n-- Business keys and hash keys\nes.orderNumber as order_bk,\n\nes.orderNumber,\nes.status.value as status_value,\nes.orderDate,\nes.salesBrand,\nes.country,\nes.currency,\n\nes.source.name as source_name,\nes.source.title as source_title,\nes.source.isExternal as source_isExternal,\n\nes.clientIP as clientIP,\nes.status.title as status_title,\n\t\nes.fraudStatus.value as fraudStatus_value,\nes.fraudStatus.title as fraudStatus_title,\n\nes.deliveryStatus.value as deliveryStatus_value,\nes.deliveryStatus.title as deliveryStatus_title,\n\nes.customerNumber as customerNumber,\n\nes.invoiceAddress.firstName as invoiceAddress_firstName,\nes.invoiceAddress.lastName as invoiceAddress_lastName,\nes.invoiceAddress.email as invoiceAddress_email,\nes.invoiceAddress.mobilePhone as invoiceAddress_mobilePhone,\nes.invoiceAddress.address.street as invoiceAddress_address_street,\nes.invoiceAddress.address.postalCode as invoiceAddress_address_postalCode,\nes.invoiceAddress.address.city as invoiceAddress_address_city,\nes.invoiceAddress.address.countryCode as invoiceAddress_address_countryCode,\n\nes.total.handlingFee as total_handlingFee,\nes.total.shippingFee as total_shippingFee,\nes.total.salesAmount as total_salesAmount,\nes.total.discount as total_discount,\nes.total.totalAmount as total_totalAmount,\nes.total.creditedAmount as total_creditedAmount,\n\nes.EventEnqueuedUtcTime as EventEnqueuedUtcTime,\nSystem.Timestamp() as updated_datetime\n\nFROM [orderupdate-stream] as es\n)\n\nselect \n* \ninto [orderupdated-orderstream]\nfrom order_explode\n"
      },
      "inputSchemas": [
        {
          "name": "orderupdate-stream",
          "schema": {
            "columns": [
              {
                "name": "orderNumber",
                "type": "Nvarchar(max)",
                "fields": null,
                "items": null
              },
              {
                "name": "orderDate",
                "type": "DateTime",
                "fields": null,
                "items": null
              },
              {
                "name": "salesBrand",
                "type": "Nvarchar(max)",
                "fields": null,
                "items": null
              },
              {
                "name": "country",
                "type": "Nvarchar(max)",
                "fields": null,
                "items": null
              },
              {
                "name": "currency",
                "type": "Nvarchar(max)",
                "fields": null,
                "items": null
              },
              {
                "name": "source",
                "type": "Record",
                "fields": [
                  {
                    "name": "name",
                    "type": "Nvarchar(max)",
                    "fields": null,
                    "items": null
                  },
                  {
                    "name": "title",
                    "type": "Nvarchar(max)",
                    "fields": null,
                    "items": null
                  },
                  {
                    "name": "isExternal",
                    "type": "BigInt",
                    "fields": null,
                    "items": null
                  }
                ],
                "items": null
              },
              {
                "name": "clientIP",
                "type": "Nvarchar(max)",
                "fields": null,
                "items": null
              },
              {
                "name": "status",
                "type": "Record",
                "fields": [
                  {
                    "name": "value",
                    "type": "Nvarchar(max)",
                    "fields": null,
                    "items": null
                  },
                  {
                    "name": "title",
                    "type": "Nvarchar(max)",
                    "fields": null,
                    "items": null
                  }
                ],
                "items": null
              },
              {
                "name": "fraudStatus",
                "type": "Record",
                "fields": [
                  {
                    "name": "value",
                    "type": "Nvarchar(max)",
                    "fields": null,
                    "items": null
                  },
                  {
                    "name": "title",
                    "type": "Nvarchar(max)",
                    "fields": null,
                    "items": null
                  }
                ],
                "items": null
              },
              {
                "name": "deliveryStatus",
                "type": "Record",
                "fields": [
                  {
                    "name": "value",
                    "type": "Nvarchar(max)",
                    "fields": null,
                    "items": null
                  },
                  {
                    "name": "title",
                    "type": "Nvarchar(max)",
                    "fields": null,
                    "items": null
                  }
                ],
                "items": null
              },
              {
                "name": "customerNumber",
                "type": "Nvarchar(max)",
                "fields": null,
                "items": null
              },
              {
                "name": "civicNumber",
                "type": "Nvarchar(max)",
                "fields": null,
                "items": null
              },
              {
                "name": "invoiceAddress",
                "type": "Record",
                "fields": [
                  {
                    "name": "firstName",
                    "type": "Nvarchar(max)",
                    "fields": null,
                    "items": null
                  },
                  {
                    "name": "lastName",
                    "type": "Nvarchar(max)",
                    "fields": null,
                    "items": null
                  },
                  {
                    "name": "address",
                    "type": "Record",
                    "fields": [
                      {
                        "name": "street",
                        "type": "Nvarchar(max)",
                        "fields": null,
                        "items": null
                      },
                      {
                        "name": "postalCode",
                        "type": "Nvarchar(max)",
                        "fields": null,
                        "items": null
                      },
                      {
                        "name": "city",
                        "type": "Nvarchar(max)",
                        "fields": null,
                        "items": null
                      },
                      {
                        "name": "countryCode",
                        "type": "Nvarchar(max)",
                        "fields": null,
                        "items": null
                      }
                    ],
                    "items": null
                  },
                  {
                    "name": "email",
                    "type": "Nvarchar(max)",
                    "fields": null,
                    "items": null
                  },
                  {
                    "name": "mobilePhone",
                    "type": "Nvarchar(max)",
                    "fields": null,
                    "items": null
                  }
                ],
                "items": null
              },
              {
                "name": "buckets",
                "type": "Array",
                "fields": null,
                "items": {
                  "name": null,
                  "type": "Record",
                  "fields": [
                    {
                      "name": "bucketNumber",
                      "type": "BigInt",
                      "fields": null,
                      "items": null
                    },
                    {
                      "name": "returnCode",
                      "type": "Nvarchar(max)",
                      "fields": null,
                      "items": null
                    },
                    {
                      "name": "deliveredFrom",
                      "type": "Record",
                      "fields": [
                        {
                          "name": "name",
                          "type": "Nvarchar(max)",
                          "fields": null,
                          "items": null
                        }
                      ],
                      "items": null
                    },
                    {
                      "name": "deliveryAddress",
                      "type": "Record",
                      "fields": [
                        {
                          "name": "firstName",
                          "type": "Nvarchar(max)",
                          "fields": null,
                          "items": null
                        },
                        {
                          "name": "lastName",
                          "type": "Nvarchar(max)",
                          "fields": null,
                          "items": null
                        },
                        {
                          "name": "address",
                          "type": "Record",
                          "fields": [
                            {
                              "name": "street",
                              "type": "Nvarchar(max)",
                              "fields": null,
                              "items": null
                            },
                            {
                              "name": "postalCode",
                              "type": "Nvarchar(max)",
                              "fields": null,
                              "items": null
                            },
                            {
                              "name": "city",
                              "type": "Nvarchar(max)",
                              "fields": null,
                              "items": null
                            },
                            {
                              "name": "countryCode",
                              "type": "Nvarchar(max)",
                              "fields": null,
                              "items": null
                            }
                          ],
                          "items": null
                        },
                        {
                          "name": "email",
                          "type": "Nvarchar(max)",
                          "fields": null,
                          "items": null
                        },
                        {
                          "name": "mobilePhone",
                          "type": "Nvarchar(max)",
                          "fields": null,
                          "items": null
                        }
                      ],
                      "items": null
                    },
                    {
                      "name": "pickupPoint",
                      "type": "Record",
                      "fields": [],
                      "items": null
                    },
                    {
                      "name": "deliveryEstimate",
                      "type": "Record",
                      "fields": [
                        {
                          "name": "date",
                          "type": "Nvarchar(max)",
                          "fields": null,
                          "items": null
                        },
                        {
                          "name": "text",
                          "type": "Nvarchar(max)",
                          "fields": null,
                          "items": null
                        }
                      ],
                      "items": null
                    },
                    {
                      "name": "shipping",
                      "type": "Record",
                      "fields": [
                        {
                          "name": "carrier",
                          "type": "Record",
                          "fields": [
                            {
                              "name": "code",
                              "type": "Nvarchar(max)",
                              "fields": null,
                              "items": null
                            },
                            {
                              "name": "name",
                              "type": "Nvarchar(max)",
                              "fields": null,
                              "items": null
                            }
                          ],
                          "items": null
                        },
                        {
                          "name": "method",
                          "type": "Nvarchar(max)",
                          "fields": null,
                          "items": null
                        },
                        {
                          "name": "title",
                          "type": "Nvarchar(max)",
                          "fields": null,
                          "items": null
                        },
                        {
                          "name": "fee",
                          "type": "BigInt",
                          "fields": null,
                          "items": null
                        },
                        {
                          "name": "returnFee",
                          "type": "Float",
                          "fields": null,
                          "items": null
                        },
                        {
                          "name": "unclaimedFee",
                          "type": "Float",
                          "fields": null,
                          "items": null
                        },
                        {
                          "name": "options",
                          "type": "Array",
                          "fields": null,
                          "items": null
                        }
                      ],
                      "items": null
                    },
                    {
                      "name": "rows",
                      "type": "Array",
                      "fields": null,
                      "items": {
                        "name": null,
                        "type": "Record",
                        "fields": [
                          {
                            "name": "rowNumber",
                            "type": "BigInt",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "sku",
                            "type": "Nvarchar(max)",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "name",
                            "type": "Nvarchar(max)",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "color",
                            "type": "Nvarchar(max)",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "size",
                            "type": "Nvarchar(max)",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "brand",
                            "type": "Record",
                            "fields": [],
                            "items": null
                          },
                          {
                            "name": "url",
                            "type": "Nvarchar(max)",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "imageName",
                            "type": "Nvarchar(max)",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "orderedQuantity",
                            "type": "BigInt",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "deliveredQuantity",
                            "type": "BigInt",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "cancelledQuantity",
                            "type": "BigInt",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "notifiedReturnQuantity",
                            "type": "BigInt",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "returnedQuantity",
                            "type": "BigInt",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "singleBasePrice",
                            "type": "Float",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "singleSalesPrice",
                            "type": "Float",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "offers",
                            "type": "Array",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "manualDiscount",
                            "type": "BigInt",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "totalDiscount",
                            "type": "BigInt",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "totalAmount",
                            "type": "Float",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "vatRate",
                            "type": "Float",
                            "fields": null,
                            "items": null
                          }
                        ],
                        "items": null
                      }
                    }
                  ],
                  "items": null
                }
              },
              {
                "name": "offers",
                "type": "Array",
                "fields": null,
                "items": null
              },
              {
                "name": "payments",
                "type": "Array",
                "fields": null,
                "items": {
                  "name": null,
                  "type": "Record",
                  "fields": [
                    {
                      "name": "title",
                      "type": "Nvarchar(max)",
                      "fields": null,
                      "items": null
                    },
                    {
                      "name": "psp",
                      "type": "Nvarchar(max)",
                      "fields": null,
                      "items": null
                    },
                    {
                      "name": "method",
                      "type": "Nvarchar(max)",
                      "fields": null,
                      "items": null
                    },
                    {
                      "name": "type",
                      "type": "Nvarchar(max)",
                      "fields": null,
                      "items": null
                    },
                    {
                      "name": "isTokenized",
                      "type": "BigInt",
                      "fields": null,
                      "items": null
                    },
                    {
                      "name": "alternative",
                      "type": "Record",
                      "fields": [],
                      "items": null
                    },
                    {
                      "name": "amount",
                      "type": "Float",
                      "fields": null,
                      "items": null
                    },
                    {
                      "name": "pspReference",
                      "type": "Nvarchar(max)",
                      "fields": null,
                      "items": null
                    }
                  ],
                  "items": null
                }
              },
              {
                "name": "logs",
                "type": "Array",
                "fields": null,
                "items": null
              },
              {
                "name": "total",
                "type": "Record",
                "fields": [
                  {
                    "name": "handlingFee",
                    "type": "Float",
                    "fields": null,
                    "items": null
                  },
                  {
                    "name": "shippingFee",
                    "type": "BigInt",
                    "fields": null,
                    "items": null
                  },
                  {
                    "name": "salesAmount",
                    "type": "Float",
                    "fields": null,
                    "items": null
                  },
                  {
                    "name": "discount",
                    "type": "BigInt",
                    "fields": null,
                    "items": null
                  },
                  {
                    "name": "totalAmount",
                    "type": "Float",
                    "fields": null,
                    "items": null
                  },
                  {
                    "name": "creditedAmount",
                    "type": "BigInt",
                    "fields": null,
                    "items": null
                  }
                ],
                "items": null
              },
              {
                "name": "deliveries",
                "type": "Array",
                "fields": null,
                "items": {
                  "name": null,
                  "type": "Record",
                  "fields": [
                    {
                      "name": "deliveryNumber",
                      "type": "Nvarchar(max)",
                      "fields": null,
                      "items": null
                    },
                    {
                      "name": "deliveryDate",
                      "type": "Nvarchar(max)",
                      "fields": null,
                      "items": null
                    },
                    {
                      "name": "carrier",
                      "type": "Record",
                      "fields": [
                        {
                          "name": "code",
                          "type": "Nvarchar(max)",
                          "fields": null,
                          "items": null
                        },
                        {
                          "name": "name",
                          "type": "Nvarchar(max)",
                          "fields": null,
                          "items": null
                        }
                      ],
                      "items": null
                    },
                    {
                      "name": "parcels",
                      "type": "Array",
                      "fields": null,
                      "items": {
                        "name": null,
                        "type": "Record",
                        "fields": [
                          {
                            "name": "parcelNumber",
                            "type": "Nvarchar(max)",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "returnParcelNumber",
                            "type": "Nvarchar(max)",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "trackingLink",
                            "type": "Nvarchar(max)",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "parcelLink",
                            "type": "Nvarchar(max)",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "returnParcelLink",
                            "type": "Nvarchar(max)",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "weight",
                            "type": "Float",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "volume",
                            "type": "Float",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "rows",
                            "type": "Array",
                            "fields": null,
                            "items": {
                              "name": null,
                              "type": "Record",
                              "fields": [
                                {
                                  "name": "rowNumber",
                                  "type": "BigInt",
                                  "fields": null,
                                  "items": null
                                },
                                {
                                  "name": "quantity",
                                  "type": "BigInt",
                                  "fields": null,
                                  "items": null
                                }
                              ],
                              "items": null
                            }
                          }
                        ],
                        "items": null
                      }
                    }
                  ],
                  "items": null
                }
              },
              {
                "name": "EventProcessedUtcTime",
                "type": "DateTime",
                "fields": null,
                "items": null
              },
              {
                "name": "PartitionId",
                "type": "BigInt",
                "fields": null,
                "items": null
              },
              {
                "name": "EventEnqueuedUtcTime",
                "type": "DateTime",
                "fields": null,
                "items": null
              }
            ]
          }
        }
      ]
    },
    {
      "name": "flatten_payment",
      "type": "SQL",
      "inputNodes": [
        {
          "name": "orderupdate-stream"
        }
      ],
      "properties": {
        "query": "with \npayment_explode as (\nSELECT \n\nes.orderNumber as order_bk,\nCONCAT(es.orderNumber, '_', payment.ArrayValue.title, '_', payment.ArrayValue.psp, '_', payment.ArrayValue.method, '_', payment.ArrayValue.pspReference) as payment_bk,\n\nes.orderNumber,\nes.status.value as status_value,\n\npayment.ArrayValue.title as title,\npayment.ArrayValue.psp as psp,\npayment.ArrayValue.method as method,\npayment.ArrayValue.alternative as alternative,\npayment.ArrayValue.amount as amount,\npayment.ArrayValue.pspReference as pspReference,\n\nes.EventEnqueuedUtcTime as EventEnqueuedUtcTime,\nSystem.Timestamp() as updated_datetime\n\nFROM [orderupdate-stream] as es\nCROSS APPLY GetArrayElements(es.payments) AS payment  \n)\n\nselect \n* \ninto [orderupdated-paymentstream]  \nfrom payment_explode\n"
      },
      "inputSchemas": [
        {
          "name": "orderupdate-stream",
          "schema": {
            "columns": [
              {
                "name": "orderNumber",
                "type": "Nvarchar(max)",
                "fields": null,
                "items": null
              },
              {
                "name": "orderDate",
                "type": "DateTime",
                "fields": null,
                "items": null
              },
              {
                "name": "salesBrand",
                "type": "Nvarchar(max)",
                "fields": null,
                "items": null
              },
              {
                "name": "country",
                "type": "Nvarchar(max)",
                "fields": null,
                "items": null
              },
              {
                "name": "currency",
                "type": "Nvarchar(max)",
                "fields": null,
                "items": null
              },
              {
                "name": "source",
                "type": "Record",
                "fields": [
                  {
                    "name": "name",
                    "type": "Nvarchar(max)",
                    "fields": null,
                    "items": null
                  },
                  {
                    "name": "title",
                    "type": "Nvarchar(max)",
                    "fields": null,
                    "items": null
                  },
                  {
                    "name": "isExternal",
                    "type": "BigInt",
                    "fields": null,
                    "items": null
                  }
                ],
                "items": null
              },
              {
                "name": "clientIP",
                "type": "Nvarchar(max)",
                "fields": null,
                "items": null
              },
              {
                "name": "status",
                "type": "Record",
                "fields": [
                  {
                    "name": "value",
                    "type": "Nvarchar(max)",
                    "fields": null,
                    "items": null
                  },
                  {
                    "name": "title",
                    "type": "Nvarchar(max)",
                    "fields": null,
                    "items": null
                  }
                ],
                "items": null
              },
              {
                "name": "fraudStatus",
                "type": "Record",
                "fields": [
                  {
                    "name": "value",
                    "type": "Nvarchar(max)",
                    "fields": null,
                    "items": null
                  },
                  {
                    "name": "title",
                    "type": "Nvarchar(max)",
                    "fields": null,
                    "items": null
                  }
                ],
                "items": null
              },
              {
                "name": "deliveryStatus",
                "type": "Record",
                "fields": [
                  {
                    "name": "value",
                    "type": "Nvarchar(max)",
                    "fields": null,
                    "items": null
                  },
                  {
                    "name": "title",
                    "type": "Nvarchar(max)",
                    "fields": null,
                    "items": null
                  }
                ],
                "items": null
              },
              {
                "name": "customerNumber",
                "type": "Nvarchar(max)",
                "fields": null,
                "items": null
              },
              {
                "name": "civicNumber",
                "type": "Nvarchar(max)",
                "fields": null,
                "items": null
              },
              {
                "name": "invoiceAddress",
                "type": "Record",
                "fields": [
                  {
                    "name": "firstName",
                    "type": "Nvarchar(max)",
                    "fields": null,
                    "items": null
                  },
                  {
                    "name": "lastName",
                    "type": "Nvarchar(max)",
                    "fields": null,
                    "items": null
                  },
                  {
                    "name": "address",
                    "type": "Record",
                    "fields": [
                      {
                        "name": "street",
                        "type": "Nvarchar(max)",
                        "fields": null,
                        "items": null
                      },
                      {
                        "name": "postalCode",
                        "type": "Nvarchar(max)",
                        "fields": null,
                        "items": null
                      },
                      {
                        "name": "city",
                        "type": "Nvarchar(max)",
                        "fields": null,
                        "items": null
                      },
                      {
                        "name": "countryCode",
                        "type": "Nvarchar(max)",
                        "fields": null,
                        "items": null
                      }
                    ],
                    "items": null
                  },
                  {
                    "name": "email",
                    "type": "Nvarchar(max)",
                    "fields": null,
                    "items": null
                  },
                  {
                    "name": "mobilePhone",
                    "type": "Nvarchar(max)",
                    "fields": null,
                    "items": null
                  }
                ],
                "items": null
              },
              {
                "name": "buckets",
                "type": "Array",
                "fields": null,
                "items": {
                  "name": null,
                  "type": "Record",
                  "fields": [
                    {
                      "name": "bucketNumber",
                      "type": "BigInt",
                      "fields": null,
                      "items": null
                    },
                    {
                      "name": "returnCode",
                      "type": "Nvarchar(max)",
                      "fields": null,
                      "items": null
                    },
                    {
                      "name": "deliveredFrom",
                      "type": "Record",
                      "fields": [
                        {
                          "name": "name",
                          "type": "Nvarchar(max)",
                          "fields": null,
                          "items": null
                        }
                      ],
                      "items": null
                    },
                    {
                      "name": "deliveryAddress",
                      "type": "Record",
                      "fields": [
                        {
                          "name": "firstName",
                          "type": "Nvarchar(max)",
                          "fields": null,
                          "items": null
                        },
                        {
                          "name": "lastName",
                          "type": "Nvarchar(max)",
                          "fields": null,
                          "items": null
                        },
                        {
                          "name": "address",
                          "type": "Record",
                          "fields": [
                            {
                              "name": "street",
                              "type": "Nvarchar(max)",
                              "fields": null,
                              "items": null
                            },
                            {
                              "name": "postalCode",
                              "type": "Nvarchar(max)",
                              "fields": null,
                              "items": null
                            },
                            {
                              "name": "city",
                              "type": "Nvarchar(max)",
                              "fields": null,
                              "items": null
                            },
                            {
                              "name": "countryCode",
                              "type": "Nvarchar(max)",
                              "fields": null,
                              "items": null
                            }
                          ],
                          "items": null
                        },
                        {
                          "name": "email",
                          "type": "Nvarchar(max)",
                          "fields": null,
                          "items": null
                        },
                        {
                          "name": "mobilePhone",
                          "type": "Nvarchar(max)",
                          "fields": null,
                          "items": null
                        }
                      ],
                      "items": null
                    },
                    {
                      "name": "pickupPoint",
                      "type": "Record",
                      "fields": [],
                      "items": null
                    },
                    {
                      "name": "deliveryEstimate",
                      "type": "Record",
                      "fields": [
                        {
                          "name": "date",
                          "type": "Nvarchar(max)",
                          "fields": null,
                          "items": null
                        },
                        {
                          "name": "text",
                          "type": "Nvarchar(max)",
                          "fields": null,
                          "items": null
                        }
                      ],
                      "items": null
                    },
                    {
                      "name": "shipping",
                      "type": "Record",
                      "fields": [
                        {
                          "name": "carrier",
                          "type": "Record",
                          "fields": [
                            {
                              "name": "code",
                              "type": "Nvarchar(max)",
                              "fields": null,
                              "items": null
                            },
                            {
                              "name": "name",
                              "type": "Nvarchar(max)",
                              "fields": null,
                              "items": null
                            }
                          ],
                          "items": null
                        },
                        {
                          "name": "method",
                          "type": "Nvarchar(max)",
                          "fields": null,
                          "items": null
                        },
                        {
                          "name": "title",
                          "type": "Nvarchar(max)",
                          "fields": null,
                          "items": null
                        },
                        {
                          "name": "fee",
                          "type": "BigInt",
                          "fields": null,
                          "items": null
                        },
                        {
                          "name": "returnFee",
                          "type": "Float",
                          "fields": null,
                          "items": null
                        },
                        {
                          "name": "unclaimedFee",
                          "type": "Float",
                          "fields": null,
                          "items": null
                        },
                        {
                          "name": "options",
                          "type": "Array",
                          "fields": null,
                          "items": null
                        }
                      ],
                      "items": null
                    },
                    {
                      "name": "rows",
                      "type": "Array",
                      "fields": null,
                      "items": {
                        "name": null,
                        "type": "Record",
                        "fields": [
                          {
                            "name": "rowNumber",
                            "type": "BigInt",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "sku",
                            "type": "Nvarchar(max)",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "name",
                            "type": "Nvarchar(max)",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "color",
                            "type": "Nvarchar(max)",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "size",
                            "type": "Nvarchar(max)",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "brand",
                            "type": "Record",
                            "fields": [],
                            "items": null
                          },
                          {
                            "name": "url",
                            "type": "Nvarchar(max)",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "imageName",
                            "type": "Nvarchar(max)",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "orderedQuantity",
                            "type": "BigInt",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "deliveredQuantity",
                            "type": "BigInt",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "cancelledQuantity",
                            "type": "BigInt",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "notifiedReturnQuantity",
                            "type": "BigInt",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "returnedQuantity",
                            "type": "BigInt",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "singleBasePrice",
                            "type": "Float",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "singleSalesPrice",
                            "type": "Float",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "offers",
                            "type": "Array",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "manualDiscount",
                            "type": "BigInt",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "totalDiscount",
                            "type": "BigInt",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "totalAmount",
                            "type": "Float",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "vatRate",
                            "type": "Float",
                            "fields": null,
                            "items": null
                          }
                        ],
                        "items": null
                      }
                    }
                  ],
                  "items": null
                }
              },
              {
                "name": "offers",
                "type": "Array",
                "fields": null,
                "items": null
              },
              {
                "name": "payments",
                "type": "Array",
                "fields": null,
                "items": {
                  "name": null,
                  "type": "Record",
                  "fields": [
                    {
                      "name": "title",
                      "type": "Nvarchar(max)",
                      "fields": null,
                      "items": null
                    },
                    {
                      "name": "psp",
                      "type": "Nvarchar(max)",
                      "fields": null,
                      "items": null
                    },
                    {
                      "name": "method",
                      "type": "Nvarchar(max)",
                      "fields": null,
                      "items": null
                    },
                    {
                      "name": "type",
                      "type": "Nvarchar(max)",
                      "fields": null,
                      "items": null
                    },
                    {
                      "name": "isTokenized",
                      "type": "BigInt",
                      "fields": null,
                      "items": null
                    },
                    {
                      "name": "alternative",
                      "type": "Record",
                      "fields": [],
                      "items": null
                    },
                    {
                      "name": "amount",
                      "type": "Float",
                      "fields": null,
                      "items": null
                    },
                    {
                      "name": "pspReference",
                      "type": "Nvarchar(max)",
                      "fields": null,
                      "items": null
                    }
                  ],
                  "items": null
                }
              },
              {
                "name": "logs",
                "type": "Array",
                "fields": null,
                "items": null
              },
              {
                "name": "total",
                "type": "Record",
                "fields": [
                  {
                    "name": "handlingFee",
                    "type": "Float",
                    "fields": null,
                    "items": null
                  },
                  {
                    "name": "shippingFee",
                    "type": "BigInt",
                    "fields": null,
                    "items": null
                  },
                  {
                    "name": "salesAmount",
                    "type": "Float",
                    "fields": null,
                    "items": null
                  },
                  {
                    "name": "discount",
                    "type": "BigInt",
                    "fields": null,
                    "items": null
                  },
                  {
                    "name": "totalAmount",
                    "type": "Float",
                    "fields": null,
                    "items": null
                  },
                  {
                    "name": "creditedAmount",
                    "type": "BigInt",
                    "fields": null,
                    "items": null
                  }
                ],
                "items": null
              },
              {
                "name": "deliveries",
                "type": "Array",
                "fields": null,
                "items": {
                  "name": null,
                  "type": "Record",
                  "fields": [
                    {
                      "name": "deliveryNumber",
                      "type": "Nvarchar(max)",
                      "fields": null,
                      "items": null
                    },
                    {
                      "name": "deliveryDate",
                      "type": "Nvarchar(max)",
                      "fields": null,
                      "items": null
                    },
                    {
                      "name": "carrier",
                      "type": "Record",
                      "fields": [
                        {
                          "name": "code",
                          "type": "Nvarchar(max)",
                          "fields": null,
                          "items": null
                        },
                        {
                          "name": "name",
                          "type": "Nvarchar(max)",
                          "fields": null,
                          "items": null
                        }
                      ],
                      "items": null
                    },
                    {
                      "name": "parcels",
                      "type": "Array",
                      "fields": null,
                      "items": {
                        "name": null,
                        "type": "Record",
                        "fields": [
                          {
                            "name": "parcelNumber",
                            "type": "Nvarchar(max)",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "returnParcelNumber",
                            "type": "Nvarchar(max)",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "trackingLink",
                            "type": "Nvarchar(max)",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "parcelLink",
                            "type": "Nvarchar(max)",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "returnParcelLink",
                            "type": "Nvarchar(max)",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "weight",
                            "type": "Float",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "volume",
                            "type": "Float",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "rows",
                            "type": "Array",
                            "fields": null,
                            "items": {
                              "name": null,
                              "type": "Record",
                              "fields": [
                                {
                                  "name": "rowNumber",
                                  "type": "BigInt",
                                  "fields": null,
                                  "items": null
                                },
                                {
                                  "name": "quantity",
                                  "type": "BigInt",
                                  "fields": null,
                                  "items": null
                                }
                              ],
                              "items": null
                            }
                          }
                        ],
                        "items": null
                      }
                    }
                  ],
                  "items": null
                }
              },
              {
                "name": "EventProcessedUtcTime",
                "type": "DateTime",
                "fields": null,
                "items": null
              },
              {
                "name": "PartitionId",
                "type": "BigInt",
                "fields": null,
                "items": null
              },
              {
                "name": "EventEnqueuedUtcTime",
                "type": "DateTime",
                "fields": null,
                "items": null
              }
            ]
          }
        }
      ]
    },
    {
      "name": "flatten_rows",
      "type": "SQL",
      "inputNodes": [
        {
          "name": "orderupdate-stream"
        }
      ],
      "properties": {
        "query": "with \nbucket_explode as (\nSELECT \n--e.buckets,\n--bucket.ArrayValue,\n--bucket.ArrayValue.bucketNumber,\n--bucket.ArrayValue.rows,\n--row_bucket.ArrayValue as bucket_row.\n\n-- Business keys and hash keys\nCONCAT(e.orderNumber, '_', bucket.ArrayValue.bucketNumber) as bucket_bk,\nCONCAT(e.orderNumber, '_', bucket.ArrayValue.bucketNumber, '_', row_bucket.ArrayValue.rowNumber) as row_bk,\n\n\ne.orderNumber,\nbucket.ArrayValue.bucketNumber as BucketNumber,\nrow_bucket.ArrayValue.rowNumber as RowNumber,\nrow_bucket.ArrayValue.sku as SKU,\nrow_bucket.ArrayValue.name as Name,\nrow_bucket.ArrayValue.color as Color,\nrow_bucket.ArrayValue.size as Size,\nrow_bucket.ArrayValue.brand as Brand,\nrow_bucket.ArrayValue.url as URL,\nrow_bucket.ArrayValue.imageName as ImageName,\nrow_bucket.ArrayValue.orderedQuantity as OrderedQuantity,\nrow_bucket.ArrayValue.deliveredQuantity as DeliveredQuantity,\nrow_bucket.ArrayValue.cancelledQuantity as CancelledQuantity,\nrow_bucket.ArrayValue.notifiedReturnQuantity as NotifiedReturnQuantity,\nrow_bucket.ArrayValue.returnedQuantity as ReturnedQuantity,\nrow_bucket.ArrayValue.singleBasePrice as SingleBasePrice,\nrow_bucket.ArrayValue.singleSalesPrice as SingleSalesPrice,\nrow_bucket.ArrayValue.manualDiscount as ManualDiscount,\nrow_bucket.ArrayValue.totalDiscount as TotalDiscount,\nrow_bucket.ArrayValue.totalAmount as TotalAmount,\nrow_bucket.ArrayValue.vatRate as VATRate,\n\n-- Additional fields from the main event\nCAST(e.orderDate AS datetime) AS orderDate, \ne.salesBrand,\ne.customerNumber,\ne.country,\ne.currency,\ne.status.value as status_value,\ne.source.isExternal as source_isExternal,\ne.source.name as source_name,\ne.deliveryStatus.value as deliveryStatus_value,\ne.fraudStatus.value as fraudStatus_value,\ne.EventEnqueuedUtcTime as source_updated_datetime,\nSystem.Timestamp() as updated_datetime\n\nFROM [orderupdate-stream] as e\nCROSS APPLY GetArrayElements(e.buckets) AS bucket  \nCROSS APPLY GetArrayElements(bucket.ArrayValue.rows) AS row_bucket  \n--where e.orderNumber = '613-20245174' \n--and e.EventEnqueuedUtcTime = '2025-10-27T08:40:38.9440000Z'\n)\n\nselect \n* \ninto [orderupdate-rowsstream]  \nfrom bucket_explode"
      },
      "inputSchemas": [
        {
          "name": "orderupdate-stream",
          "schema": {
            "columns": [
              {
                "name": "orderNumber",
                "type": "Nvarchar(max)",
                "fields": null,
                "items": null
              },
              {
                "name": "orderDate",
                "type": "DateTime",
                "fields": null,
                "items": null
              },
              {
                "name": "salesBrand",
                "type": "Nvarchar(max)",
                "fields": null,
                "items": null
              },
              {
                "name": "country",
                "type": "Nvarchar(max)",
                "fields": null,
                "items": null
              },
              {
                "name": "currency",
                "type": "Nvarchar(max)",
                "fields": null,
                "items": null
              },
              {
                "name": "source",
                "type": "Record",
                "fields": [
                  {
                    "name": "name",
                    "type": "Nvarchar(max)",
                    "fields": null,
                    "items": null
                  },
                  {
                    "name": "title",
                    "type": "Nvarchar(max)",
                    "fields": null,
                    "items": null
                  },
                  {
                    "name": "isExternal",
                    "type": "BigInt",
                    "fields": null,
                    "items": null
                  }
                ],
                "items": null
              },
              {
                "name": "clientIP",
                "type": "Nvarchar(max)",
                "fields": null,
                "items": null
              },
              {
                "name": "status",
                "type": "Record",
                "fields": [
                  {
                    "name": "value",
                    "type": "Nvarchar(max)",
                    "fields": null,
                    "items": null
                  },
                  {
                    "name": "title",
                    "type": "Nvarchar(max)",
                    "fields": null,
                    "items": null
                  }
                ],
                "items": null
              },
              {
                "name": "fraudStatus",
                "type": "Record",
                "fields": [
                  {
                    "name": "value",
                    "type": "Nvarchar(max)",
                    "fields": null,
                    "items": null
                  },
                  {
                    "name": "title",
                    "type": "Nvarchar(max)",
                    "fields": null,
                    "items": null
                  }
                ],
                "items": null
              },
              {
                "name": "deliveryStatus",
                "type": "Record",
                "fields": [
                  {
                    "name": "value",
                    "type": "Nvarchar(max)",
                    "fields": null,
                    "items": null
                  },
                  {
                    "name": "title",
                    "type": "Nvarchar(max)",
                    "fields": null,
                    "items": null
                  }
                ],
                "items": null
              },
              {
                "name": "customerNumber",
                "type": "Nvarchar(max)",
                "fields": null,
                "items": null
              },
              {
                "name": "civicNumber",
                "type": "Nvarchar(max)",
                "fields": null,
                "items": null
              },
              {
                "name": "invoiceAddress",
                "type": "Record",
                "fields": [
                  {
                    "name": "firstName",
                    "type": "Nvarchar(max)",
                    "fields": null,
                    "items": null
                  },
                  {
                    "name": "lastName",
                    "type": "Nvarchar(max)",
                    "fields": null,
                    "items": null
                  },
                  {
                    "name": "address",
                    "type": "Record",
                    "fields": [
                      {
                        "name": "street",
                        "type": "Nvarchar(max)",
                        "fields": null,
                        "items": null
                      },
                      {
                        "name": "postalCode",
                        "type": "Nvarchar(max)",
                        "fields": null,
                        "items": null
                      },
                      {
                        "name": "city",
                        "type": "Nvarchar(max)",
                        "fields": null,
                        "items": null
                      },
                      {
                        "name": "countryCode",
                        "type": "Nvarchar(max)",
                        "fields": null,
                        "items": null
                      }
                    ],
                    "items": null
                  },
                  {
                    "name": "email",
                    "type": "Nvarchar(max)",
                    "fields": null,
                    "items": null
                  },
                  {
                    "name": "mobilePhone",
                    "type": "Nvarchar(max)",
                    "fields": null,
                    "items": null
                  }
                ],
                "items": null
              },
              {
                "name": "buckets",
                "type": "Array",
                "fields": null,
                "items": {
                  "name": null,
                  "type": "Record",
                  "fields": [
                    {
                      "name": "bucketNumber",
                      "type": "BigInt",
                      "fields": null,
                      "items": null
                    },
                    {
                      "name": "returnCode",
                      "type": "Nvarchar(max)",
                      "fields": null,
                      "items": null
                    },
                    {
                      "name": "deliveredFrom",
                      "type": "Record",
                      "fields": [
                        {
                          "name": "name",
                          "type": "Nvarchar(max)",
                          "fields": null,
                          "items": null
                        }
                      ],
                      "items": null
                    },
                    {
                      "name": "deliveryAddress",
                      "type": "Record",
                      "fields": [
                        {
                          "name": "firstName",
                          "type": "Nvarchar(max)",
                          "fields": null,
                          "items": null
                        },
                        {
                          "name": "lastName",
                          "type": "Nvarchar(max)",
                          "fields": null,
                          "items": null
                        },
                        {
                          "name": "address",
                          "type": "Record",
                          "fields": [
                            {
                              "name": "street",
                              "type": "Nvarchar(max)",
                              "fields": null,
                              "items": null
                            },
                            {
                              "name": "postalCode",
                              "type": "Nvarchar(max)",
                              "fields": null,
                              "items": null
                            },
                            {
                              "name": "city",
                              "type": "Nvarchar(max)",
                              "fields": null,
                              "items": null
                            },
                            {
                              "name": "countryCode",
                              "type": "Nvarchar(max)",
                              "fields": null,
                              "items": null
                            }
                          ],
                          "items": null
                        },
                        {
                          "name": "email",
                          "type": "Nvarchar(max)",
                          "fields": null,
                          "items": null
                        },
                        {
                          "name": "mobilePhone",
                          "type": "Nvarchar(max)",
                          "fields": null,
                          "items": null
                        }
                      ],
                      "items": null
                    },
                    {
                      "name": "pickupPoint",
                      "type": "Record",
                      "fields": [],
                      "items": null
                    },
                    {
                      "name": "deliveryEstimate",
                      "type": "Record",
                      "fields": [
                        {
                          "name": "date",
                          "type": "Nvarchar(max)",
                          "fields": null,
                          "items": null
                        },
                        {
                          "name": "text",
                          "type": "Nvarchar(max)",
                          "fields": null,
                          "items": null
                        }
                      ],
                      "items": null
                    },
                    {
                      "name": "shipping",
                      "type": "Record",
                      "fields": [
                        {
                          "name": "carrier",
                          "type": "Record",
                          "fields": [
                            {
                              "name": "code",
                              "type": "Nvarchar(max)",
                              "fields": null,
                              "items": null
                            },
                            {
                              "name": "name",
                              "type": "Nvarchar(max)",
                              "fields": null,
                              "items": null
                            }
                          ],
                          "items": null
                        },
                        {
                          "name": "method",
                          "type": "Nvarchar(max)",
                          "fields": null,
                          "items": null
                        },
                        {
                          "name": "title",
                          "type": "Nvarchar(max)",
                          "fields": null,
                          "items": null
                        },
                        {
                          "name": "fee",
                          "type": "BigInt",
                          "fields": null,
                          "items": null
                        },
                        {
                          "name": "returnFee",
                          "type": "Float",
                          "fields": null,
                          "items": null
                        },
                        {
                          "name": "unclaimedFee",
                          "type": "Float",
                          "fields": null,
                          "items": null
                        },
                        {
                          "name": "options",
                          "type": "Array",
                          "fields": null,
                          "items": null
                        }
                      ],
                      "items": null
                    },
                    {
                      "name": "rows",
                      "type": "Array",
                      "fields": null,
                      "items": {
                        "name": null,
                        "type": "Record",
                        "fields": [
                          {
                            "name": "rowNumber",
                            "type": "BigInt",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "sku",
                            "type": "Nvarchar(max)",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "name",
                            "type": "Nvarchar(max)",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "color",
                            "type": "Nvarchar(max)",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "size",
                            "type": "Nvarchar(max)",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "brand",
                            "type": "Record",
                            "fields": [],
                            "items": null
                          },
                          {
                            "name": "url",
                            "type": "Nvarchar(max)",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "imageName",
                            "type": "Nvarchar(max)",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "orderedQuantity",
                            "type": "BigInt",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "deliveredQuantity",
                            "type": "BigInt",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "cancelledQuantity",
                            "type": "BigInt",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "notifiedReturnQuantity",
                            "type": "BigInt",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "returnedQuantity",
                            "type": "BigInt",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "singleBasePrice",
                            "type": "Float",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "singleSalesPrice",
                            "type": "Float",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "offers",
                            "type": "Array",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "manualDiscount",
                            "type": "BigInt",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "totalDiscount",
                            "type": "BigInt",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "totalAmount",
                            "type": "Float",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "vatRate",
                            "type": "Float",
                            "fields": null,
                            "items": null
                          }
                        ],
                        "items": null
                      }
                    }
                  ],
                  "items": null
                }
              },
              {
                "name": "offers",
                "type": "Array",
                "fields": null,
                "items": null
              },
              {
                "name": "payments",
                "type": "Array",
                "fields": null,
                "items": {
                  "name": null,
                  "type": "Record",
                  "fields": [
                    {
                      "name": "title",
                      "type": "Nvarchar(max)",
                      "fields": null,
                      "items": null
                    },
                    {
                      "name": "psp",
                      "type": "Nvarchar(max)",
                      "fields": null,
                      "items": null
                    },
                    {
                      "name": "method",
                      "type": "Nvarchar(max)",
                      "fields": null,
                      "items": null
                    },
                    {
                      "name": "type",
                      "type": "Nvarchar(max)",
                      "fields": null,
                      "items": null
                    },
                    {
                      "name": "isTokenized",
                      "type": "BigInt",
                      "fields": null,
                      "items": null
                    },
                    {
                      "name": "alternative",
                      "type": "Record",
                      "fields": [],
                      "items": null
                    },
                    {
                      "name": "amount",
                      "type": "Float",
                      "fields": null,
                      "items": null
                    },
                    {
                      "name": "pspReference",
                      "type": "Nvarchar(max)",
                      "fields": null,
                      "items": null
                    }
                  ],
                  "items": null
                }
              },
              {
                "name": "logs",
                "type": "Array",
                "fields": null,
                "items": null
              },
              {
                "name": "total",
                "type": "Record",
                "fields": [
                  {
                    "name": "handlingFee",
                    "type": "Float",
                    "fields": null,
                    "items": null
                  },
                  {
                    "name": "shippingFee",
                    "type": "BigInt",
                    "fields": null,
                    "items": null
                  },
                  {
                    "name": "salesAmount",
                    "type": "Float",
                    "fields": null,
                    "items": null
                  },
                  {
                    "name": "discount",
                    "type": "BigInt",
                    "fields": null,
                    "items": null
                  },
                  {
                    "name": "totalAmount",
                    "type": "Float",
                    "fields": null,
                    "items": null
                  },
                  {
                    "name": "creditedAmount",
                    "type": "BigInt",
                    "fields": null,
                    "items": null
                  }
                ],
                "items": null
              },
              {
                "name": "deliveries",
                "type": "Array",
                "fields": null,
                "items": {
                  "name": null,
                  "type": "Record",
                  "fields": [
                    {
                      "name": "deliveryNumber",
                      "type": "Nvarchar(max)",
                      "fields": null,
                      "items": null
                    },
                    {
                      "name": "deliveryDate",
                      "type": "Nvarchar(max)",
                      "fields": null,
                      "items": null
                    },
                    {
                      "name": "carrier",
                      "type": "Record",
                      "fields": [
                        {
                          "name": "code",
                          "type": "Nvarchar(max)",
                          "fields": null,
                          "items": null
                        },
                        {
                          "name": "name",
                          "type": "Nvarchar(max)",
                          "fields": null,
                          "items": null
                        }
                      ],
                      "items": null
                    },
                    {
                      "name": "parcels",
                      "type": "Array",
                      "fields": null,
                      "items": {
                        "name": null,
                        "type": "Record",
                        "fields": [
                          {
                            "name": "parcelNumber",
                            "type": "Nvarchar(max)",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "returnParcelNumber",
                            "type": "Nvarchar(max)",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "trackingLink",
                            "type": "Nvarchar(max)",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "parcelLink",
                            "type": "Nvarchar(max)",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "returnParcelLink",
                            "type": "Nvarchar(max)",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "weight",
                            "type": "Float",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "volume",
                            "type": "Float",
                            "fields": null,
                            "items": null
                          },
                          {
                            "name": "rows",
                            "type": "Array",
                            "fields": null,
                            "items": {
                              "name": null,
                              "type": "Record",
                              "fields": [
                                {
                                  "name": "rowNumber",
                                  "type": "BigInt",
                                  "fields": null,
                                  "items": null
                                },
                                {
                                  "name": "quantity",
                                  "type": "BigInt",
                                  "fields": null,
                                  "items": null
                                }
                              ],
                              "items": null
                            }
                          }
                        ],
                        "items": null
                      }
                    }
                  ],
                  "items": null
                }
              },
              {
                "name": "EventProcessedUtcTime",
                "type": "DateTime",
                "fields": null,
                "items": null
              },
              {
                "name": "PartitionId",
                "type": "BigInt",
                "fields": null,
                "items": null
              },
              {
                "name": "EventEnqueuedUtcTime",
                "type": "DateTime",
                "fields": null,
                "items": null
              }
            ]
          }
        }
      ]
    }
  ],
  "compatibilityLevel": "1.1"
}